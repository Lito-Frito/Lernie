services:
###############  Media-Streaming Containers  ################
  plex:
    image: lscr.io/linuxserver/plex:latest
    container_name: plex
    network_mode: host
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - VERSION=docker
      - PLEX_CLAIM=SOMETHING # make .env
      - PLEX_GID=${PGID:-1000}
      - PLEX_UID=${PUID:-1000}
      - UMASK_SET=022
      - ADVERTISE_IP=SOMETHING # make .env
    volumes:
      - ./plex/config:/config
      - ./data/media/tv:/data/tv
      - ./data/media/movies:/data/movies
      - /tmp:/transcode # Have transcoding happen in RAM
    restart: unless-stopped
    devices:
      - /dev/dri/:/dev/dri/
      
# TODO: Consider adding Jellyfin or Kodi or Emby as an alternative to Plex

###############  Media-Management Containers  ################
  bazarr: # For subtitle management
    container_name: bazarr
    image: lscr.io/linuxserver/bazarr:latest
    restart: unless-stopped
    logging:
      driver: json-file
    ports:
      - 6767:6767
    environment:
      - PUID=1000
      - PGID=1000 
      - TZ=America/New_York 
    volumes:
      - /etc/localtime:/etc/localtime:ro # look into applying this to others or removing overall
      - ./bazarr:/config
      - ./data/media/movies:/data/media/movies
      - ./data/media/tv:/data/media/tv

  radarr: # For movie management
    container_name: radarr
    image: lscr.io/linuxserver/radarr:latest
    restart: unless-stopped
    logging:
      driver: json-file
    ports:
      - 7878:7878
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/New_York 
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - ./radarr:/config
      - ./data/media/movies:/media/movies
      - ./qbittorent/downloads:/downloads

  sonarr: # For TV show management
    container_name: sonarr
    image: lscr.io/linuxserver/sonarr:latest
    restart: unless-stopped
    logging:
      driver: json-file
    ports:
      - 8989:8989
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/New_York 
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - ./sonarr:/config
      - ./data/media/tv:/media/tv
      - ./qbittorent/downloads:/downloads
# Todo: Look into adding Overseer container for requests

###############  Media-fetching Containers  ################
  jackett: # For torrent/indexer searching (i.e. finding media)
      image: lscr.io/linuxserver/jackett:latest
      container_name: jackett
      environment:
        - PUID=1000
        - PGID=1000
        - TZ=America/New_York
        - AUTO_UPDATE=true 
        # - RUN_OPTS= #optional
      volumes:
        - /etc/localtime:/etc/localtime:ro
        - ./jackett:/config
        - ./qbittorent/downloads:/downloads
      ports:
        - 9117:9117
      # restart: unless-stopped (Consider adding this?)

# TODO: look into adding a qbit container for torrenting

###############  Networking-management  ################
  cloudflare_tunnel: # For remote access
      image: cloudflare/cloudflared:latest
      container_name: river_styx # Change to the name of your choosing
      environment:
        - TZ=America/New_York # set this to your own desired timezone
      volumes:
        - ./cloudflared/data:/home/nonroot/.cloudflared/ # Change this to your desired path
      command: tunnel run --token ${TUNNEL_TOKEN} # ${TUNNEL_TOKEN} should come from a .env file with the format of 'TUNNEL_TOKEN=_some_token_value_'
      network_mode: host
      restart: unless-stopped
